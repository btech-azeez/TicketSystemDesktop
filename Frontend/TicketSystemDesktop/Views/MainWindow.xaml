<Window x:Class="TicketSystemDesktop.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Ticket System Dashboard" Height="700" Width="1100"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundBrush}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Modern Header -->
        <Border Grid.Row="0" Padding="25,15">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="#7C3AED" Offset="0"/>
                    <GradientStop Color="#4F46E5" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Ticket System" FontSize="22" FontWeight="ExtraBold" 
                               Foreground="White" VerticalAlignment="Center"/>
                    <Border Background="#33FFFFFF" CornerRadius="12" Padding="10,4" Margin="15,0,0,0" VerticalAlignment="Center">
                        <TextBlock Text="DASHBOARD" FontSize="11" FontWeight="Bold" Foreground="White"/>
                    </Border>
                </StackPanel>
                
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <TextBlock x:Name="lblUserInfo" Foreground="White" VerticalAlignment="Center" 
                               Margin="0,0,25,0" FontSize="14" FontWeight="SemiBold"/>
                    <Button x:Name="btnLogout" Content="Sign Out" Padding="15,7" Click="BtnLogout_Click" 
                            Background="#22FFFFFF" BorderThickness="0" FontSize="12">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content Area -->
        <Border Grid.Row="1" Margin="25" Background="White" CornerRadius="12">
            <Border.Effect>
                <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.05"/>
            </Border.Effect>
            
            <TabControl x:Name="tabControl" Background="Transparent" BorderThickness="0" Margin="15">
                <TabControl.Resources>
                    <Style TargetType="TabItem">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="TabItem">
                                    <Border x:Name="border" BorderThickness="0,0,0,3" Margin="0,0,20,0" Padding="10,10">
                                        <ContentPresenter ContentSource="Header" TextBlock.FontSize="15" TextBlock.FontWeight="SemiBold"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
                                            <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="False">
                                            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </TabControl.Resources>

                <!-- Tickets Tab -->
                <TabItem Header="My Support Tickets" x:Name="tabMyTickets">
                    <Grid Margin="0,20,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <DockPanel Grid.Row="0" Margin="0,0,0,20">
                            <TextBlock Text="Manage your requests" FontSize="18" FontWeight="Bold" Foreground="{StaticResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button x:Name="btnRefresh" Content="Refresh" Width="100" Click="BtnRefresh_Click" 
                                        Background="Transparent" Foreground="{StaticResource PrimaryBrush}"/>
                                <Button x:Name="btnCreateTicket" Content="+ Create New Ticket" 
                                       Click="BtnCreateTicket_Click" Width="180" Margin="10,0,0,0" 
                                       Background="{StaticResource AccentBrush}"/>
                            </StackPanel>
                        </DockPanel>

                        <DataGrid Grid.Row="1" x:Name="dgTickets" 
                                 AutoGenerateColumns="False" IsReadOnly="True"
                                 MouseDoubleClick="DgTickets_MouseDoubleClick">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" Binding="{Binding TicketNumber}" Width="100" MinWidth="80"/>
                                <DataGridTextColumn Header="Subject" Binding="{Binding Subject}" Width="*" MinWidth="200"/>
                                <DataGridTemplateColumn Header="Priority" Width="100" MinWidth="100">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border CornerRadius="4" Padding="8,4" HorizontalAlignment="Left">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Priority}" Value="High">
                                                                <Setter Property="Background" Value="#FEE2E2"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding Priority}" Value="Medium">
                                                                <Setter Property="Background" Value="#FEF3C7"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding Priority}" Value="Low">
                                                                <Setter Property="Background" Value="#D1FAE5"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <TextBlock Text="{Binding Priority}" FontSize="12" FontWeight="Bold">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Priority}" Value="High">
                                                                    <Setter Property="Foreground" Value="#991B1B"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Priority}" Value="Medium">
                                                                    <Setter Property="Foreground" Value="#92400E"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Priority}" Value="Low">
                                                                    <Setter Property="Foreground" Value="#065F46"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="110" MinWidth="100"/>
                                <DataGridTextColumn Header="Created" Binding="{Binding CreatedDate, StringFormat='{}{0:MMM dd, HH:mm}'}" Width="130" MinWidth="120"/>
                                <DataGridTextColumn Header="Assigned To" Binding="{Binding AssignedToName}" Width="140" MinWidth="120"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </TabItem>

                <!-- All Tickets Tab (Admin Only) -->
                <TabItem Header="System Administration" x:Name="tabAllTickets" Visibility="Collapsed">
                    <Grid Margin="0,20,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <DockPanel Grid.Row="0" Margin="0,0,0,20">
                            <TextBlock Text="All System Tickets" FontSize="18" FontWeight="Bold" Foreground="{StaticResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                            <Button x:Name="btnRefreshAll" Content="Refresh Data" 
                                   Click="BtnRefreshAll_Click" Width="130" HorizontalAlignment="Right"/>
                        </DockPanel>

                        <DataGrid Grid.Row="1" x:Name="dgAllTickets" 
                                 AutoGenerateColumns="False" IsReadOnly="True"
                                 MouseDoubleClick="DgAllTickets_MouseDoubleClick">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" Binding="{Binding TicketNumber}" Width="100" MinWidth="80"/>
                                <DataGridTextColumn Header="Subject" Binding="{Binding Subject}" Width="*" MinWidth="200"/>
                                <DataGridTextColumn Header="Priority" Binding="{Binding Priority}" Width="90" MinWidth="90"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100" MinWidth="100"/>
                                <DataGridTextColumn Header="Raised By" Binding="{Binding CreatedByName}" Width="130" MinWidth="110"/>
                                <DataGridTextColumn Header="Date" Binding="{Binding CreatedDate, StringFormat='{}{0:MMM dd}'}" Width="100" MinWidth="80"/>
                                <DataGridTextColumn Header="Assigned" Binding="{Binding AssignedToName}" Width="130" MinWidth="110"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </TabItem>
            </TabControl>
        </Border>
    </Grid>
</Window>
